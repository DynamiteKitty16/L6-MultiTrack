<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}MultiTracker{% endblock %}</title>

    <!-- Link to the compiled Tailwind CSS -->
    {% load static %}
    <link href="{% static 'css/output.css' %}" rel="stylesheet">

    {% block extra_head %}{% endblock %}
</head>
<body>
    <header>
        <nav>
            {% if request.path != '/' %}
                <a href="/">Home</a>
            {% endif %}
            {% if user.is_authenticated %}
                <a href="/dashboard/">Dashboard</a>
                <a href="/logout/">Logout</a>
            {% endif %}
        </nav>
    </header>    
    <main>
        {% block content %}{% endblock %}
    </main>
    <footer>
        <p>&copy; 2024 MultiTracker</p>
    </footer>

    {% if user.is_authenticated %}
        <script>
            // Get session expiry time from Django (in seconds) and convert it to a number
            const sessionTimeout = parseInt("{{ session_expiry }}");
            const warningTime = sessionTimeout - 30; // Warn user 30 seconds before session expires

            // Notify the user before session timeout
            setTimeout(() => {
                alert("You will be logged out due to inactivity in 30 seconds. Please save your work.");
            }, warningTime * 1000);

            // Automatically log the user out when the session expires
            setTimeout(() => {
                window.location.href = "{% url 'custom_logout' %}";
            }, sessionTimeout * 1000);
        </script>
    {% endif %}
</body>
</html>
